--- sys/src/9/port/dev.c	Thu Mar 13 02:36:45 2008
+++ sys/src/9/port/dev.c	Thu Mar 13 02:36:44 2008
@@ -125,6 +125,7 @@
 Chan*
 devattach(int tc, char *spec)
 {
+	int n;
 	Chan *c;
 	char *buf;
 
@@ -133,13 +134,12 @@
 	c->type = devno(tc, 0);
 	if(spec == nil)
 		spec = "";
-	buf = smalloc(4+strlen(spec)+1);
-	sprint(buf, "#%C%s", tc, spec);
+	buf = smalloc(n = 4+strlen(spec)+1);
+	snprint(buf, n, "#%C%s", tc, spec);
 	c->path = newpath(buf);
 	free(buf);
 	return c;
 }
-
 
 Chan*
 devclone(Chan *c)
